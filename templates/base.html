<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#2563eb">
    <meta name="description" content="Book your rides easily with Maksim - Your trusted ride booking platform">
    <title>{% block title %}Ride Booking Platform{% endblock %}</title>
    {% load static %}
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{% static 'css/palette.css' %}?v=2" rel="stylesheet">
    <link href="{% static 'css/custom.css' %}" rel="stylesheet">
    <link href="{% static 'css/animations.css' %}" rel="stylesheet">
    <link href="{% static 'css/rides.css' %}" rel="stylesheet">
    <style>
        :root {
            /* Accessible neutral & background */
            --bg: #F8FAFC;               /* very light neutral background */
            --white: #FFFFFF;
            --text-color: #0F172A;       /* near-black for readable text */
            --muted: #6B7280;            /* secondary text */

            /* Primary (blue) and its RGB for translucent uses */
            --safety-blue: #2563EB;      /* primary brand blue */
            --safety-blue-rgb: 37, 99, 235;
            --safety-blue-dark: #1D4ED8;
            --safety-blue-light: #DBEAFE;

            /* Complementary accent (warm) */
            --accent-amber: #F59E0B;     /* amber/orange accent */
            --accent-amber-rgb: 245, 158, 11;

            /* Supporting colors */
            --medium-gray: #CBD5E1;      /* soft border / muted surfaces */
            --brand-green: #16A34A;      /* success / positive */
            --brand-green-light: #D1FAE5;
            --alert-red: #DC2626;        /* errors */

            /* Compatibility aliases for older CSS that still uses previous variable names */
            --black: var(--text-color);
            --text-primary: var(--text-color);
            --text-secondary: #475569;
            --text-muted: var(--muted);
            --text-light: #94a3b8;

            --background-main: var(--white);
            --background-light: var(--bg);
            --background-subtle: #F1F5F9;
            --background-muted: #E2E8F0;

            --border-light: #E2E8F0;
            --border-medium: var(--medium-gray);
            --border-dark: #94A3B8;

            --shadow-color: rgba(2,6,23,0.06);
        }

         body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg);
            line-height: 1.5;
         }

         .navbar {
            background-color: var(--white) !important;
            box-shadow: 0 2px 6px rgba(2,6,23,0.06);
            border-bottom: 1px solid rgba(15,23,42,0.06);
         }

         .navbar-brand {
            color: var(--text-color) !important;
             font-weight: 600;
         }

         .nav-link {
            color: var(--text-color) !important;
             font-weight: 500;
         }

         .nav-link:hover {
            color: var(--safety-blue) !important;
         }

         .btn-primary {
            background-color: var(--safety-blue);
            border-color: var(--safety-blue);
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            color: var(--white);
         }

         .btn-primary:hover {
            background-color: rgba(var(--safety-blue-rgb), 0.95);
            border-color: rgba(var(--safety-blue-rgb), 0.95);
         }

         .card {
            border: 1px solid rgba(2,6,23,0.06);
            border-radius: 12px;
            box-shadow: 0 6px 18px rgba(2,6,23,0.04);
         }

         .form-control, .form-select {
            border: 1px solid rgba(2,6,23,0.08);
            border-radius: 8px;
            padding: 0.75rem 1rem;
         }

         .form-control:focus, .form-select:focus {
            border-color: var(--safety-blue);
            box-shadow: 0 0 0 4px rgba(var(--safety-blue-rgb), 0.10);
         }

         .alert {
             border-radius: 8px;
             font-weight: 500;
         }

         .balance-display {
            background: rgba(var(--safety-blue-rgb), 0.08);
            color: var(--safety-blue);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 600;
         }
     </style>
    <!-- Forceful overrides loaded last to make sure the new palette is applied -->
    <link href="{% static 'css/override.css' %}?v=2" rel="stylesheet">
    <!-- Inline immediate overrides (no-cache) to force the new palette in the browser right away -->
    <style>
        /* Minimal inline set to immediately enforce key colors */
        html, body { background-color: var(--bg) !important; color: var(--text-color) !important; }
        a, a * { color: var(--safety-blue) !important; }
        a:hover, a:focus { color: var(--safety-blue-dark) !important; }
        .navbar, .navbar * { background-color: var(--white) !important; color: var(--text-color) !important; }
        .navbar .nav-link, .navbar .navbar-brand { color: var(--text-color) !important; }
        .btn, .btn-primary, button, input[type=submit] { background-color: var(--safety-blue) !important; color: var(--white) !important; border-color: var(--safety-blue) !important; }
        .btn-outline-primary { color: var(--safety-blue) !important; border-color: var(--safety-blue) !important; background-color: transparent !important; }
        .card, .dropdown-menu, .quick-actions { background-color: var(--white) !important; border-color: var(--border-light) !important; color: var(--text-color) !important; }
        h1,h2,h3,h4,h5,h6, .card-title { color: var(--text-color) !important; }
        .lead, p { color: var(--muted) !important; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="{% url 'home' %}">Maksim</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    {% if user.is_authenticated %}
                        {% if user.user_role == 'customer' %}
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'create_ride' %}">Book a Ride</a>
                            </li>
                        {% endif %}
                        {% if user.user_role == 'rider' %}
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'ride_list' %}">Available Rides</a>
                            </li>
                        {% endif %}
                        {% if user.user_role == 'staff' %}
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'dashboard:home' %}">Dashboard</a>
                            </li>
                        {% endif %}
                    {% endif %}
                </ul>
                <ul class="navbar-nav">
                    {% if user.is_authenticated %}
                        <li class="nav-item me-3">
                            <a class="nav-link" href="{% url 'accounts:profile' %}">
                                <i class="fas fa-user me-2"></i>{{ user.get_full_name }}
                                <span class="balance-display ms-2">â‚±{{ user.balance }}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'accounts:logout' %}">
                                <i class="fas fa-sign-out-alt me-2"></i>Sign Out
                            </a>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'accounts:login' %}">
                                <i class="fas fa-sign-in-alt me-2"></i>Sign In
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'accounts:signup' %}">
                                <i class="fas fa-user-plus me-2"></i>Sign Up
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}

        {% block content %}{% endblock %}
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    {% block extra_js %}{% endblock %}
    <!-- Debug overlay (visible if you add ?debug=1 to the URL) -->
    <div id="palette-debug" style="display:none;position:fixed;right:12px;bottom:12px;background:rgba(15,23,42,0.9);color:#fff;padding:10px 12px;border-radius:8px;font-family:Inter,Arial, sans-serif;font-size:12px;z-index:99999;max-width:320px;line-height:1.3;">
        <strong style="display:block;margin-bottom:6px;font-weight:600;font-size:13px;">Palette debug</strong>
        <div id="palette-debug-content">Loading...</div>
        <div style="margin-top:8px;text-align:right;font-size:11px;color:rgba(255,255,255,0.7);">Use ?debug=1 to show</div>
    </div>
    <script>
        (function(){
            try{
                if(new URLSearchParams(window.location.search).get('debug') !== '1') return;
                var root = getComputedStyle(document.documentElement);
                var keys = ['--safety-blue','--safety-blue-rgb','--text-color','--bg','--white','--muted','--accent-amber'];
                var out = keys.map(function(k){
                    var v = root.getPropertyValue(k) || '(not set)';
                    return '<div><span style="color:#9CA3AF;">'+k+'</span>: <span style="color:#fff;font-weight:600;">'+v.trim()+'</span></div>';
                }).join('');
                document.getElementById('palette-debug-content').innerHTML = out;
                document.getElementById('palette-debug').style.display = 'block';
            }catch(e){
                console.error('palette debug error', e);
            }
        })();
    </script>
</body>
</html>
